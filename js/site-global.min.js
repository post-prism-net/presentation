debugmode=!0,debuglog=function(log){debugmode&&"undefined"!=typeof console&&console.log(log)},requestAnimationFramePolyfill=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(callback){window.setTimeout(callback,1e3/60)},config=new Array;var site=function(){{var isJumping,isScrolling,init=function(){debuglog("site.init()"),bindEventHandlers(),path.init(),sections.init(),nav.init(),win.init()},bindEventHandlers=function(){$(document).on("keypress",function(e){(37==e.keyCode||38==e.keyCode)&&(debuglog("prev"),e.preventDefault(),sections.getPrev()&&(location.hash="/"+sections.getPrev()+"/")),(39==e.keyCode||40==e.keyCode)&&(debuglog("next"),e.preventDefault(),sections.getNext()&&(location.hash="/"+sections.getNext()+"/"))})},win=function(){var winEl,winScrollTop,winHeight,resizeDelay,scrollSpeed=1.5,init=function(){debuglog("site.win.init()"),winEl=$(window),winHeight=winEl.height(),isJumping=!1,isScrolling=!1,bindEventHandlers(),scrollLoop()},bindEventHandlers=function(){winEl.on("resize",function(){resizeDelay&&clearTimeout(resizeDelay),resizeDelay=setTimeout(resize,1e3)})},scrollLoop=function(){var _winScrollTop=winScrollTop;winScrollTop=winEl.scrollTop(),winScrollTop!=_winScrollTop?(isScrolling=!0,scroll()):isScrolling=!1,requestAnimationFramePolyfill(scrollLoop)},scroll=function(){debuglog("site.win.scroll()"),sections.check(winScrollTop,winHeight)},scrollTo=function(el,offset){if(debuglog("site.win.scrollTo( "+el+", "+offset+" )"),el.length>0&&!isScrolling){var offset=offset||0,position=el.position().top-offset,distance=Math.floor(Math.abs(position-winScrollTop)),duration=Math.floor(distance/scrollSpeed);debuglog("position: "+position),debuglog("duration: "+duration),isJumping=!0,$("html,body").animate({scrollTop:position},duration,"easeInOutQuart",function(){isJumping=!1})}},resize=function(){sections.init(),init()};return{init:function(){init()},scrollTo:function(el,offset){scrollTo(el,offset)},resize:function(){resize()}}}(),sections=function(){var current,_current,cache=new Array,init=function(){debuglog("site.sections.init()"),bindEventHandlers(),createCache()},bindEventHandlers=function(){},createCache=function(){$("section").each(function(){var section=new Array;section.slug=$(this).attr("data-section"),section.title=$(this).attr("data-title"),section.offset=Math.floor($(this).position().top),cache.push(section)}),debuglog(cache)},check=function(scrollTop,winHeight){for(var i=0;i<cache.length;i++)scrollTop>cache[i].offset-2*winHeight/3&&(current=cache[i].slug);current!=_current&&change(current),_current=current},change=function(slug){debuglog("site.sections.change( "+slug+" )"),nav.mark(slug),mark(slug),_current&&!isJumping&&path.set(slug)},mark=function(slug){debuglog("site.sections.mark( "+slug+" )"),$("section").removeClass("current"),$('section[data-section="'+slug+'"]').addClass("current")},getNext=function(){var index;for(i=0;i<cache.length;i++)cache[i].slug==current&&(index=i);if(index<cache.length-1){var next=cache[index+1].slug;return next}return!1},getPrev=function(){var index;for(i=0;i<cache.length;i++)cache[i].slug==current&&(index=i);if(index>0){var prev=cache[index-1].slug;return prev}return!1},getSections=function(){return debuglog("site.sections.getSections()"),cache};return{init:function(){init()},getSections:function(){return getSections()},getNext:function(){return getNext()},getPrev:function(){return getPrev()},check:function(scrollTop,winHeight){return check(scrollTop,winHeight)}}}(),nav=function(){var navEl,_current,init=function(){debuglog("site.nav.init()"),navEl=build(),_current=void 0,bindEventHandlers()},bindEventHandlers=function(){},build=function(){debuglog("site.nav.build()"),$("nav").length>0&&$("nav").remove();for(var html=$("<nav><h1>post-prism.net</h1><span><ul></ul></span></nav>"),ul=html.find("ul"),s=sections.getSections(),i=0;i<s.length;i++)item=$('<li><a href="#/'+s[i].slug+'/">'+s[i].title+"</a></li>"),ul.append(item);return html.prependTo($("body")),html},mark=function(slug){if(debuglog("site.nav.mark( "+slug+" )"),slug!=_current){var liHeight=navEl.find("li").first().height();navEl.find("a").not('[href$="#/'+slug+'/"]').closest("li").removeClass("current"),navEl.find('[href$="#/'+slug+'/"]').closest("li").addClass("current");var index=navEl.find("li").index(navEl.find(".current"))+1,marginTop=parseInt(liHeight)*(index-1)*-1;navEl.find("li").first().css({marginTop:marginTop+"px"}),_current=slug}};return{init:function(){init()},mark:function(slug){mark(slug)}}}(),path=function(){var section,linksEl,init=function(){linksEl=$('[href^="#"]'),saveLinks(),rewriteLinks(),bindEventHandlers(),checkPath($.address.value())},bindEventHandlers=function(){$.address.externalChange(function(){checkPath($.address.value())})},saveLinks=function(){debuglog("site.path.saveLinks()"),linksEl.not("[data-url]").each(function(){$(this).attr("data-url",$(this).attr("href"))})},rewriteLinks=function(){debuglog("site.path.rewriteLinks()"),linksEl.each(function(){var link=$(this),url=link.attr("href").replace("#","");url="#/"+url,link.attr("href",url)})},set=function(path){debuglog("site.path.set( "+path+" )"),$.address.path(path)},checkPath=function(path){debuglog("path.checkPath("+path+")");var path=path||"";if(path=path.split("/"),section=path[1]||"home"){var target=$('[data-section="'+section+'"]');win.scrollTo(target)}};return{init:function(){init()},set:function(path){set(path)}}}();!function(){var init=function(){debuglog("site.module.init()"),bindEventHandlers()},bindEventHandlers=function(){};return{init:function(){init()}}}()}return{init:function(){init()}}}();$(document).ready(function(){config.blogurl=location.protocol+"//"+location.hostname+location.pathname,config.breakpoint=$("title").css("width"),config.mediaquery=$("title").css("fontFamily").replace(/'/g,"").replace(/"/g,""),debuglog("site-global.js loaded..."),debuglog(config.blogurl),debuglog(config.mediaquery),site.init(),$("html").removeClass("no-js")});